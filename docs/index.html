<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Diccionario de Procedimientos</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
  <meta name="description" content="Sistema unificado de procedimientos y automatizaciones">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0">
  
  <!-- Tema -->
  <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/docsify@4/lib/themes/vue.css">
  
  <!-- Estilos personalizados -->
  <style>
    :root {
      --theme-color: #2c3e50;
      --sidebar-width: 300px;
    }
    
    .sidebar {
      background: #f8f9fa;
    }
    
    .search input {
      border: 2px solid #e0e0e0;
      border-radius: 5px;
    }
    
    .pdf-container {
      width: 100%;
      min-height: 600px;
      margin: 20px 0;
    }
    
    .pdf-viewer {
      width: 100%;
      height: 800px;
      border: 1px solid #ddd;
      border-radius: 5px;
    }
    
    .pdf-fallback {
      background: #f5f5f5;
      padding: 30px;
      text-align: center;
      border-radius: 8px;
      border: 2px dashed #ddd;
    }
    
    .pdf-fallback a {
      display: inline-block;
      background: var(--theme-color);
      color: white;
      padding: 12px 24px;
      border-radius: 5px;
      text-decoration: none;
      margin: 10px;
      font-weight: bold;
    }
    
    .pdf-fallback a:hover {
      opacity: 0.9;
    }
    
    .procedure-card {
      background: #f5f5f5;
      padding: 15px;
      margin: 10px 0;
      border-radius: 8px;
      border-left: 4px solid var(--theme-color);
    }
    
    /* Mejoras para m√≥vil */
    @media screen and (max-width: 768px) {
      .pdf-viewer {
        height: 500px;
      }
      
      .sidebar {
        font-size: 14px;
      }
    }
  </style>
</head>
<body>
  <div id="app">Cargando...</div>
  
  <script>
    window.$docsify = {
      name: 'üìö Diccionario de Procedimientos',
      repo: '',
      loadSidebar: true,
      subMaxLevel: 3,
      auto2top: true,
      
      // B√∫squeda
      search: {
        maxAge: 86400000,
        paths: 'auto',
        placeholder: 'üîç Buscar procedimientos...',
        noData: 'No se encontraron resultados',
        depth: 6,
        hideOtherSidebarContent: false,
      },
      
      // Paginaci√≥n
      pagination: {
        previousText: 'Anterior',
        nextText: 'Siguiente',
      },
      
      // Copiar c√≥digo
      copyCode: {
        buttonText: 'Copiar',
        errorText: 'Error',
        successText: '‚úì Copiado'
      },
      
      // Plugin personalizado para manejar PDFs
      plugins: [
        function(hook, vm) {
          // Interceptar enlaces a PDFs
          hook.beforeEach(function(content) {
            // Agregar fecha de √∫ltima actualizaci√≥n
            var footer = '\n\n---\n*√öltima actualizaci√≥n: ' + new Date().toLocaleDateString('es-ES') + '*';
            return content + footer;
          });
          
          // Manejar carga de PDFs
          hook.doneEach(function() {
            // Detectar enlaces a PDFs
            var pdfLinks = document.querySelectorAll('a[href$=".pdf"]');
            
            pdfLinks.forEach(function(link) {
              // Si no tiene la clase de ignorar
              if (!link.hasAttribute('data-pdf-processed')) {
                link.setAttribute('data-pdf-processed', 'true');
                
                // Agregar evento click
                link.addEventListener('click', function(e) {
                  var href = this.getAttribute('href');
                  
                  // En m√≥vil, abrir en nueva pesta√±a directamente
                  if (window.innerWidth < 768) {
                    e.preventDefault();
                    window.open(href, '_blank');
                    return false;
                  }
                  
                  // En escritorio, intentar mostrar con PDFObject
                  e.preventDefault();
                  
                  // Crear contenedor para el PDF
                  var container = document.createElement('div');
                  container.className = 'pdf-container';
                  container.innerHTML = '<div id="pdf-viewer-' + Date.now() + '"></div>';
                  
                  // Reemplazar contenido
                  var contentDiv = document.querySelector('.content');
                  if (contentDiv) {
                    contentDiv.innerHTML = '';
                    contentDiv.appendChild(container);
                    
                    var viewerId = container.querySelector('[id^="pdf-viewer-"]').id;
                    
                    // Intentar cargar PDF con PDFObject
                    if (typeof PDFObject !== 'undefined') {
                      PDFObject.embed(href, '#' + viewerId, {
                        height: '800px',
                        fallbackLink: '<div class="pdf-fallback"><p>üìÑ No se puede mostrar el PDF en este navegador</p><a href="' + href + '" target="_blank">üì• Descargar PDF</a><a href="' + href + '" target="_blank">üëÅÔ∏è Ver en nueva pesta√±a</a></div>'
                      });
                    } else {
                      // Fallback si PDFObject no est√° disponible
                      document.getElementById(viewerId).innerHTML = 
                        '<div class="pdf-fallback"><p>üìÑ Visualizador de PDF</p><a href="' + href + '" target="_blank">üì• Descargar PDF</a><a href="' + href + '" target="_blank">üëÅÔ∏è Ver en nueva pesta√±a</a></div>';
                    }
                  }
                  
                  return false;
                });
              }
            });
          });
        }
      ]
    }
  </script>
  
  <!-- Docsify core -->
  <script src="//cdn.jsdelivr.net/npm/docsify@4"></script>
  
  <!-- Plugin de b√∫squeda -->
  <script src="//cdn.jsdelivr.net/npm/docsify/lib/plugins/search.min.js"></script>
  
  <!-- Plugin de zoom para im√°genes -->
  <script src="//cdn.jsdelivr.net/npm/docsify/lib/plugins/zoom-image.min.js"></script>
  
  <!-- Plugin de copiar c√≥digo -->
  <script src="//cdn.jsdelivr.net/npm/docsify-copy-code@2"></script>
  
  <!-- Plugin de paginaci√≥n -->
  <script src="//cdn.jsdelivr.net/npm/docsify-pagination/dist/docsify-pagination.min.js"></script>
  
  <!-- Soporte para PDF -->
  <script src="//cdn.jsdelivr.net/npm/pdfobject@2.2.8/pdfobject.min.js"></script>
  
</body>
</html>
