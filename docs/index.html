<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Diccionario de Procedimientos</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
  <meta name="description" content="Sistema unificado de procedimientos y automatizaciones">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0">
  
  <!-- Tema -->
  <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/docsify@4/lib/themes/vue.css">
  
  <!-- Estilos personalizados -->
  <style>
    :root {
      --theme-color: #2c3e50;
      --sidebar-width: 300px;
    }
    
    .sidebar {
      background: #f8f9fa;
    }
    
    .sidebar-nav > ul > li > p {
      font-weight: bold;
      margin: 10px 0 5px 0;
    }
    
    .search input {
      border: 2px solid #e0e0e0;
      border-radius: 5px;
    }
    
    .pdf-container {
      width: 100%;
      min-height: 600px;
      margin: 20px 0;
    }
    
    .pdf-viewer {
      width: 100%;
      height: 800px;
      border: 1px solid #ddd;
      border-radius: 5px;
    }
    
    .pdf-fallback {
      background: #f5f5f5;
      padding: 30px;
      text-align: center;
      border-radius: 8px;
      border: 2px dashed #ddd;
    }
    
    .pdf-fallback h3 {
      color: var(--theme-color);
      margin-bottom: 20px;
    }
    
    .pdf-fallback a {
      display: inline-block;
      background: var(--theme-color);
      color: white;
      padding: 12px 24px;
      border-radius: 5px;
      text-decoration: none;
      margin: 10px;
      font-weight: bold;
      transition: opacity 0.3s;
    }
    
    .pdf-fallback a:hover {
      opacity: 0.8;
    }
    
    .procedure-card {
      background: #f5f5f5;
      padding: 15px;
      margin: 10px 0;
      border-radius: 8px;
      border-left: 4px solid var(--theme-color);
    }
    
    /* Ocultar el TOC autom√°tico del README */
    .content .sidebar-nav {
      display: none !important;
    }
    
    /* Mejoras para m√≥vil */
    @media screen and (max-width: 768px) {
      .pdf-viewer {
        height: 500px;
      }
      
      .sidebar {
        font-size: 14px;
      }
      
      .pdf-fallback a {
        display: block;
        margin: 10px 0;
      }
    }

    /* ===== MEN√ö COLAPSABLE ===== */

    /* El <p> que act√∫a como cabecera de grupo (sin link) */
    .sidebar-nav > ul > li > p {
      cursor: pointer;
      user-select: none;
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 4px 0;
      transition: color 0.2s;
    }

    .sidebar-nav > ul > li > p:hover {
      color: var(--theme-color);
    }

    /* Flecha indicadora */
    .sidebar-nav > ul > li > p::after {
      content: '‚ñæ';
      font-size: 12px;
      margin-left: 6px;
      transition: transform 0.25s ease;
      opacity: 0.5;
      flex-shrink: 0;
    }

    /* Cuando est√° colapsado, rotar la flecha */
    .sidebar-nav > ul > li.collapsed > p::after {
      transform: rotate(-90deg);
    }

    /* Ocultar la lista de hijos cuando est√° colapsado */
    .sidebar-nav > ul > li.collapsed > ul {
      display: none;
    }

    /* Animaci√≥n suave al expandir */
    .sidebar-nav > ul > li > ul {
      overflow: hidden;
      transition: all 0.25s ease;
    }
  </style>
</head>
<body>
  <div id="app">Cargando...</div>
  
  <script>
    window.$docsify = {
      name: 'üìö Diccionario de Procedimientos',
      repo: '',
      loadSidebar: true,
      hideSidebar: false,
      subMaxLevel: 1,
      auto2top: true,
      maxLevel: 4,
      
      // Desactivar el √≠ndice autom√°tico del contenido
      toc: {
        tocMaxLevel: 0,
        target: 'h2'
      },
      
      // B√∫squeda
      search: {
        maxAge: 86400000,
        paths: 'auto',
        placeholder: 'üîç Buscar procedimientos...',
        noData: 'No se encontraron resultados',
        depth: 6,
        hideOtherSidebarContent: false,
      },
      
      // Paginaci√≥n
      pagination: {
        previousText: 'Anterior',
        nextText: 'Siguiente',
      },
      
      // Copiar c√≥digo
      copyCode: {
        buttonText: 'Copiar',
        errorText: 'Error',
        successText: '‚úì Copiado'
      },
      
      // Alias para evitar problemas con rutas
      alias: {
        '/.*/_sidebar.md': '/_sidebar.md',
      },
      
      // Plugins
      plugins: [
        // ===== CERRAR MODAL AL CAMBIAR DE P√ÅGINA =====
        function(hook) {
          hook.beforeEach(function(content) {
            var modal = document.getElementById('pdf-modal');
            if (modal && modal.classList.contains('active')) {
              modal.classList.remove('active');
              var iframe = document.getElementById('modal-iframe');
              if (iframe) iframe.src = '';
              document.body.style.overflow = '';
            }
            return content;
          });
        },

        // ===== PLUGIN MEN√ö COLAPSABLE =====
        function(hook) {
          hook.doneEach(function() {
            setTimeout(function() {
              var currentHash = window.location.hash || '';
              var topItems = document.querySelectorAll('.sidebar-nav > ul > li');

              topItems.forEach(function(li) {
                var p = li.querySelector(':scope > p');
                var ul = li.querySelector(':scope > ul');

                if (!p || !ul) return;

                // Bind click solo una vez
                if (!p.getAttribute('data-collapsible')) {
                  p.setAttribute('data-collapsible', 'true');
                  p.addEventListener('click', function() {
                    li.classList.toggle('collapsed');
                  });
                }

                // Verificar si alg√∫n link hijo coincide con la URL actual
                var links = li.querySelectorAll('a');
                var tieneActivo = false;
                links.forEach(function(a) {
                  var href = a.getAttribute('href') || '';
                  if (currentHash.indexOf(href.replace(/^#/, '')) !== -1 && href.length > 2) {
                    tieneActivo = true;
                  }
                });

                if (tieneActivo) {
                  // Mantener abierto si un hijo coincide con la URL
                  li.classList.remove('collapsed');
                } else {
                  // Si no tiene hijo activo y no estaba ya abierto por click, colapsar
                  if (!li.getAttribute('data-opened')) {
                    li.classList.add('collapsed');
                  }
                }
              });

            }, 50);
          });
        }
      ]
    }
  </script>
  
  <!-- Docsify core -->
  <script src="//cdn.jsdelivr.net/npm/docsify@4"></script>
  
  <!-- Plugin de b√∫squeda -->
  <script src="//cdn.jsdelivr.net/npm/docsify/lib/plugins/search.min.js"></script>
  
  <!-- Plugin de zoom para im√°genes -->
  <script src="//cdn.jsdelivr.net/npm/docsify/lib/plugins/zoom-image.min.js"></script>
  
  <!-- Plugin de copiar c√≥digo -->
  <script src="//cdn.jsdelivr.net/npm/docsify-copy-code@2"></script>
  
  <!-- Plugin de paginaci√≥n -->
  <script src="//cdn.jsdelivr.net/npm/docsify-pagination/dist/docsify-pagination.min.js"></script>
  
  <!-- Soporte para PDF -->
  <script src="//cdn.jsdelivr.net/npm/pdfobject@2.2.8/pdfobject.min.js"></script>

  <!-- Funciones globales modal PDF -->
  <script>
    function openPreview(url, title) {
      var modal = document.getElementById("pdf-modal");
      if (!modal) return;
      document.getElementById("modal-title").textContent = title;
      document.getElementById("modal-iframe").src = url;
      modal.classList.add("active");
      document.body.style.overflow = "hidden";
    }
    function closeModal() {
      var modal = document.getElementById("pdf-modal");
      if (!modal) return;
      modal.classList.remove("active");
      document.getElementById("modal-iframe").src = "";
      document.body.style.overflow = "";
    }
    function closePreview(event) {
      if (event.target === document.getElementById("pdf-modal")) closeModal();
    }
  </script>
  
</body>
</html>